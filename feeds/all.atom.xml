<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>PabRod</title><link href="https://pabrod.github.io/" rel="alternate"></link><link href="https://pabrod.github.io/feeds/all.atom.xml" rel="self"></link><id>https://pabrod.github.io/</id><updated>2020-10-24T11:17:17+02:00</updated><subtitle>Applied mathematician. Science storyteller</subtitle><entry><title>Daylight charts with R</title><link href="https://pabrod.github.io/clock-en.html" rel="alternate"></link><published>2020-10-24T11:17:17+02:00</published><updated>2020-10-24T11:17:17+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2020-10-24:/clock-en.html</id><summary type="html">&lt;p&gt;This weekend most of Europe says goodbye to summertime. Visualize the consequences using R.&lt;/p&gt;</summary><content type="html">&lt;p&gt;It happens every year. Twice. And it can be pretty annoying. I am talking about the clock shift to re-adapt our schedules to wintertime or summertime. But did you know that this October 25 may be the last time this happens? Well… at least if you are reading these lines from Europe.&lt;/p&gt;
&lt;p&gt;But, why do we do it? Changing the clocks reduces the undesirable effects of an astronomical phenomenon: that of the variability of sunlight hours during the year. To make it even more difficult, this variability depends not only on the day of the year but also on the location on Earth.&lt;/p&gt;
&lt;p&gt;Luckily, the study of the relationship between daylight duration, position, and date is one of the oldest objects of study. There are some early references in the Babylonian time, the topic was already covered in Ptolemy’s &lt;em&gt;Almagest&lt;/em&gt;, and it is part of the everyday life of sailors since, at least, the publication of the first nautical almanacs in the 1700s.&lt;/p&gt;
&lt;p&gt;We can summarize all we need in charts like this:&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/PabRod/daylight-charts"&gt;&lt;img alt="Bacelona" src="images/2020-10/Barcelona.png"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The figure above is a daylight chart corresponding to the city of Barcelona, Spain, in the year 2020. The abrupt changes correspond with the spring and autumn clock shifts. Notice how the clock shift keeps the sunrise around 8:00 AM.&lt;/p&gt;
&lt;p&gt;I've generated the chart in &lt;em&gt;R&lt;/em&gt;. Nowadays, quick and simple access to astronomical and geographical databases makes it easier than ever to simulate daylight charts at any point in the world. In particular, I wrote &lt;a href="https://github.com/PabRod/daylight-charts"&gt;this code in R&lt;/a&gt; to generate such diagrams. It relies on the CRAN packages:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;maps&lt;/code&gt;: for converting the name of a city into its geographical coordinates.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lutz&lt;/code&gt;: for extracting the official timezone from the coordinates.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;suncalc&lt;/code&gt;: for deriving the sunset and sunrise times at the selected location.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It can be run as an interactive applet, either in &lt;a href="https://pabrod.shinyapps.io/cambio-de-hora/"&gt;Shinyapps&lt;/a&gt; or &lt;a href="https://github.com/PabRod/daylight-charts"&gt;locally&lt;/a&gt;, to query for any city in the EU with a population over 100k. Additionally, I precalculated a collection of daylight charts for &lt;a href="https://github.com/PabRod/daylight-charts/tree/master/figs/nl"&gt;Dutch&lt;/a&gt;, &lt;a href="https://github.com/PabRod/daylight-charts/tree/master/figs/es"&gt;Spanish&lt;/a&gt;, and other &lt;a href="https://github.com/PabRod/daylight-charts/tree/master/figs/eu"&gt;European&lt;/a&gt; towns with a population over 100k.&lt;/p&gt;
&lt;p&gt;This entry appears in &lt;a href="https://www.r-bloggers.com"&gt;R-bloggers.com&lt;/a&gt;&lt;/p&gt;</content><category term="Blog"></category><category term="math"></category><category term="R"></category></entry><entry><title>Los modelos matemáticos no predicen el futuro, pero ayudan a entenderlo</title><link href="https://pabrod.github.io/modelos-es.html" rel="alternate"></link><published>2020-10-20T16:38:15+02:00</published><updated>2020-10-20T16:38:15+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2020-10-20:/modelos-es.html</id><summary type="html">&lt;p&gt;¿Para qué sirven (y para qué no sirven) los modelos matemáticos?&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;span&gt;&lt;a href="https://theconversation.com/profiles/pablo-rodriguez-sanchez-1150140"&gt;Pablo Rodríguez-Sánchez&lt;/a&gt;, &lt;em&gt;&lt;a href="https://theconversation.com/institutions/netherlands-escience-center-4836"&gt; Netherlands eScience Center&lt;/a&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Permítanme comenzar con una pregunta a bocajarro: ¿piensa usted que es posible predecir el futuro? Esta pregunta, así formulada, evoca bolas de cristal y lectura de manos y nos invita a responder con un rotundo “no”.&lt;/p&gt;

&lt;p&gt;Sin embargo, enunciados como “la temperatura media global subirá 0,5 ⁰C en la próxima década” o “la curva de contagios por el coronavirus empezará a aplanarse dentro de tres días” nos resultan mucho más fiables. Estas frases, enunciadas de esta manera, evocan conceptos como ciencia, conocimiento experto y rigor. Sin embargo, también son predicciones sobre el futuro.&lt;/p&gt;

&lt;p&gt;Si buceamos en los fundamentos de este tipo de predicciones, es muy probable que hayan sido obtenidas utilizando modelos matemáticos. Además, vendrán acompañadas de “barras de error” que aporten numerosos matices al enunciado y, en cierto modo, le resten contundencia.&lt;/p&gt;

&lt;p&gt;Los modelos matemáticos están viviendo su momento de fama. Por culpa de la pandemia de la COVID-19 han saltado de las páginas de las revistas especializadas a las de la prensa generalista. Por obvios motivos de formato, los detalles necesarios para comprender su alcance y limitaciones rara vez se mencionan. Esto puede generar una impresión equivocada sobre la utilidad de los mismos.&lt;/p&gt;

&lt;h2&gt;¿Qué es un modelo matemático?&lt;/h2&gt;

&lt;p&gt;Un modelo es una descripción más o menos detallada de un fenómeno que se desea investigar. Un modelo matemático usa el lenguaje matemático en su descripción. &lt;/p&gt;

&lt;p&gt;Suena casi como un trabalenguas, pero en el fondo no tiene nada de exótico. Es más, es muy posible que el lector haya trabajado con modelos matemáticos antes. Concretamente, en la escuela. ¿Recuerdan aquellos problemas sobre interés compuesto? ¿O los del tiro parabólico y la caída libre? ¿Acaso no les pedían usar las matemáticas para calcular cómo evolucionaba una cuenta bancaria o cómo se movía un proyectil?&lt;/p&gt;

&lt;p&gt;Al contrario de lo que a menudo se piensa, los modelos matemáticos no responden a la pregunta “¿qué va a pasar?”, sino a la pregunta “¿qué pasaría si?”. Esto constituye, a la vez, su mayor debilidad y su mayor fortaleza.&lt;/p&gt;

&lt;p&gt;Permítanme ilustrarlo con el ejemplo de la caída libre. Es posible que en la escuela les hablaran de aquella “demostración matemática” de que una pluma y una bala de cañón que caen libremente desde la misma altura llegan al suelo al mismo tiempo. &lt;/p&gt;

&lt;p&gt;Suena raro, pero es rigurosamente cierto… siempre que la caída sea de verdad libre (esto es, en ausencia de atmósfera). &lt;/p&gt;

&lt;figure&gt;
            &lt;iframe width="440" height="260" src="https://www.youtube.com/embed/E43-CfukEgs?wmode=transparent&amp;amp;start=0" frameborder="0" allowfullscreen=""&gt;&lt;/iframe&gt;

          &lt;/figure&gt;

&lt;p&gt;Si tratamos de aplicar el modelo de caída libre para estudiar la caída de un objeto cotidiano, y por tanto rodeado de aire, veremos que sus predicciones fracasan miserablemente. Hemos usado un modelo poco adecuado, pues responde a la pregunta: ¿qué pasaría si dejo caer este objeto &lt;em&gt;si no hubiera atmósfera&lt;/em&gt;?&lt;/p&gt;

&lt;p&gt;Cuando los matemáticos construimos modelos, a menudo empezamos con un modelo sencillo, al que vamos añadiendo nuevas características según van resultando necesarias. ¿Cuándo paramos? Cuando el modelo es lo suficientemente adecuado. Es decir, cuando estamos satisfechos con la luz que arroja sobre el fenómeno que deseamos estudiar.&lt;/p&gt;

&lt;p&gt;Si queremos estudiar la caída de una pluma, el modelo anterior nos dejará claramente insatisfechos. Si al modelo de caída libre le añadimos un término de rozamiento con el aire, los resultados serán mucho mejores, pero aún existirán pequeñas discrepancias con el experimento.&lt;/p&gt;

&lt;p&gt;Cualquier modelo, sin excepción, es una aproximación más o menos sofisticada de la realidad, pero nunca perfecta. Por desgracia, cuantificar cómo de preciso es un modelo matemático no siempre es una tarea sencilla. Por lo tanto, tampoco lo es comunicarlo al público general.&lt;/p&gt;

&lt;h2&gt;¿Por qué los usamos entonces?&lt;/h2&gt;

&lt;p&gt;Si todos los modelos son aproximados, ¿por qué los usamos? Por una sencilla razón: porque son útiles. La capacidad de los modelos matemáticos de responder a la pregunta “¿qué pasaría si?” los convierte en interesantes sustitutos de los experimentos científicos. &lt;/p&gt;

&lt;p&gt;Si bien en ciencia el experimento es el rey, a veces no queda más remedio que conformarse con un modelo matemático o computacional.&lt;/p&gt;

&lt;p&gt;Ejemplos de estas situaciones: &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Experimentos irrealizables: el estudio &lt;em&gt;in situ&lt;/em&gt; de un agujero negro.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Costosos o difíciles: el estudio de la evolución de las poblaciones de plancton, cuya escala en el espacio y el tiempo es del orden de océanos y décadas.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Destructivos o peligrosos: el análisis de los efectos de un terremoto en determinada ciudad. &lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Los modelos también son de gran utilidad para obtener visualizaciones difíciles o imposibles de lograr experimentalmente (cómo se mueve el viento alrededor de una turbina).&lt;/p&gt;

&lt;p&gt;Por si fuera poco, incluso modelos matemáticos con muy poco poder predictivo pueden ser de gran utilidad para entender problemas complejos. &lt;/p&gt;

&lt;p&gt;Gracias, por ejemplo, a un &lt;a href="https://fuga.naukas.com/2020/03/18/un-matematico-en-cuarentena/"&gt;sencillísimo modelo de propagación de epidemias&lt;/a&gt; de los años 20 sabemos que existen umbrales (el famoso &lt;a href="https://theconversation.com/coronavirus-sigue-siendo-util-el-numero-r-139044#:%7E:text=El%20n%C3%BAmero%20R%20es%20el,algo%20por%20encima%20del%203."&gt;número R&lt;/a&gt;) a partir de los cuales el contagio se dispara. El modelo no permite saber con exactitud cuál es el umbral, pero aporta la idea misma de que existe.&lt;/p&gt;

&lt;h2&gt;Los matemáticos no pueden predecir el futuro&lt;/h2&gt;

&lt;p&gt;Recuerde nuestra pregunta inicial. ¿El futuro se puede predecir? Ninguna persona razonable respondería con un rotundo “sí, siempre y sin matices”. Espero haberles convencido de que los matemáticos, por lo general también personas razonables, tampoco.&lt;/p&gt;

&lt;p&gt;La ciencia es una empresa, por naturaleza, incompleta, se escriba esta con letras o con fórmulas. Los modelos matemáticos han de leerse con, por lo menos, el mismo sano escepticismo que la predicción meteorológica.&lt;!-- Below is The Conversation's page counter tag. Please DO NOT REMOVE. --&gt;&lt;img src="https://counter.theconversation.com/content/147299/count.gif?distributor=republish-lightbox-basic" alt="The Conversation" width="1" height="1" style="border: none !important; box-shadow: none !important; margin: 0 !important; max-height: 1px !important; max-width: 1px !important; min-height: 1px !important; min-width: 1px !important; opacity: 0 !important; outline: none !important; padding: 0 !important; text-shadow: none !important" /&gt;&lt;!-- Fin del código. Si no ve ningún código arriba, por favor, obtenga el nuevo código de la pestaña Avanzado después de hacer clic en el botón de republicar. El contador de páginas no recoge ningún dato personal. Más información: http://theconversation.com/es/republishing-guidelines --&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;&lt;a href="https://theconversation.com/profiles/pablo-rodriguez-sanchez-1150140"&gt;Pablo Rodríguez-Sánchez&lt;/a&gt;, Especialista en computación científica, &lt;em&gt;&lt;a href="https://theconversation.com/institutions/netherlands-escience-center-4836"&gt; Netherlands eScience Center&lt;/a&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Este artículo fue publicado originalmente en  &lt;a href="https://theconversation.com"&gt;The Conversation&lt;/a&gt;. Lea el &lt;a href="https://theconversation.com/los-modelos-matematicos-no-predicen-el-futuro-pero-ayudan-a-entenderlo-147299"&gt;original&lt;/a&gt;.&lt;/p&gt;</content><category term="Blog"></category><category term="math"></category></entry><entry><title>Talk announcement: CENL CVs</title><link href="https://pabrod.github.io/cenl-en.html" rel="alternate"></link><published>2020-10-15T09:41:28+02:00</published><updated>2020-10-15T09:41:28+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2020-10-15:/cenl-en.html</id><summary type="html">&lt;p&gt;Science and Experiences of Spanish Scientists in the Netherlands&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Poster&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://www.eventbrite.com/e/cvs-cenl-2020-tickets-120247600811"&gt;&lt;img alt="poster" src="images/2020-10/poster.jpeg"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Spacetime coordinates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;16 October 2020, 17:30 CEST. Online, free &lt;a href="https://www.eventbrite.com/e/cvs-cenl-2020-tickets-120247600811"&gt;registration&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Slides&lt;/h2&gt;
&lt;p&gt;The slides are temporarily available &lt;a href="https://www.dropbox.com/s/yos2hu1m1za90lx/CENL.pptx?dl=0"&gt;here&lt;/a&gt;.&lt;/p&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Talk announcement: Complex numbers for research software engineers</title><link href="https://pabrod.github.io/complex-sig-en.html" rel="alternate"></link><published>2020-10-12T09:07:06+02:00</published><updated>2020-10-12T09:07:06+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2020-10-12:/complex-sig-en.html</id><summary type="html">&lt;p&gt;A talk about applications of complex numbers in computational sciences&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Title&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Complex numbers for research software engineers&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;If you are reading this, most likely you are working on a computer-science related field.
Why would you care about the square root of minus one (also known as i)? Let me give you a few reasons:&lt;/p&gt;
&lt;p&gt;The mysterious number i:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;is the NaN of the Renaissance.&lt;/li&gt;
&lt;li&gt;appears in the Euler's identity, acclaimed as the most beautiful equation ever.&lt;/li&gt;
&lt;li&gt;allowed for difficult computations in aerodynamics before the computer was invented.&lt;/li&gt;
&lt;li&gt;can improve your numerical differentiation algorithms with minimal effort.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The slides are temporarily available &lt;a href="https://www.dropbox.com/s/18dmbov56d5vfm2/Complex%20numbers.pptx?dl=0"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Spacetime coordinates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;12 October 2020, 11:00 CEST. Online, for eScience Center members only.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="slides" src="images/2020-10/wing.gif"&gt;&lt;/p&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Talk announcement: Thesis defense</title><link href="https://pabrod.github.io/defense-en.html" rel="alternate"></link><published>2020-06-08T16:22:24+02:00</published><updated>2020-06-08T16:22:24+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2020-06-08:/defense-en.html</id><summary type="html">&lt;p&gt;The day finally arrived!&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Invitation&lt;/h2&gt;
&lt;p&gt;I am happy to inform you that next week I'll be publicly defending my PhD thesis entitled:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Cycles and interactions: a mathematician among biologists&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The defense will be conducted in English language.&lt;/p&gt;
&lt;h2&gt;Spacetime coordinates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;15 June 2020, 13:30 CEST. The ceremony will take place exclusivelly &lt;a href="https://weblectures.wur.nl/P2G/Player/Player.aspx?id=C217"&gt;online&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="slides" src="images/2020-06/defense.png"&gt;&lt;/p&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;The backbone of this thesis is the interdisciplinary interaction between dynamic systems theory and a selection of biological problems. Each chapter focuses in one problem, namely plankton dynamics, cell development paths and sleep-wake dynamics. Despite these topics may seem disconnected, they share an important feature: all of them show cyclic behaviour under certain circumstances.&lt;/p&gt;
&lt;p&gt;In the present thesis we show that cyclic (or chaotic) behaviour is deeply related with plankton biodiversity. We also use cycles to show, in an intuitive way, that Waddington’s epigenetic landscapes (a common visual tool in stem cell research) are poorly defined, and we provide a practical solution to this. Lastly, we provide an algorithm to forecast a transition between synchronized and non-synchronized cyclic systems (such as normal sleep – insomnia, or normal hearth functioning – arrhythmia), with potential applications in medical sciences.&lt;/p&gt;
&lt;p&gt;The thesis is temporarily available &lt;a href="https://www.dropbox.com/sh/kg147e5x0o09ddl/AABvsbPApgMXJhBSQNnfqa1Ja?dl=0"&gt;here&lt;/a&gt;.&lt;/p&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Notificación: Defensa de tesis</title><link href="https://pabrod.github.io/defense-es.html" rel="alternate"></link><published>2020-06-08T16:22:24+02:00</published><updated>2020-06-08T16:22:24+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2020-06-08:/defense-es.html</id><summary type="html">&lt;p&gt;¡Por fin ha llegado el día!&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Invitación&lt;/h2&gt;
&lt;p&gt;Me complace informar de que la próxima semana defenderé publicamente mi tesis doctoral, que lleva por título:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Ciclos e interacciones: un matemático entre biólogos&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;La defensa tendrá lugar en idioma inglés.&lt;/p&gt;
&lt;h2&gt;Coordenadas espaciotemporales&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;15 de Junio de 2020, 13:30 CEST. La ceremonia será exclusivamente &lt;a href="https://weblectures.wur.nl/P2G/Player/Player.aspx?id=C217"&gt;online&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="slides" src="images/2020-06/defense.png"&gt;&lt;/p&gt;
&lt;h2&gt;Resumen&lt;/h2&gt;
&lt;p&gt;La columna vertebral de esta tesis es la interacción entre la teoría de sistemas dinámicos y una selección de problemas biológicos. Cada capítulo se centra en uno de estos problemas, particularmente dinámica de poblaciones de plankton, desarrollo celular y ciclos sueño-vigilia. A pesar de que estos temas pueden parecer desconectados, todos comparten una característica común: presentan un comportamiento cíclico bajo determinadas circunstancias.&lt;/p&gt;
&lt;p&gt;En la tesis que nos ocupa mostramos que el comportamiento cíclico (o caótico) está íntimamente relacionado con la biodiversidad del plankton. También usamos ciclos para mostrar, de forma intuitiva, que los mapas epigenéticos de Waddington (una herramienta visual muy habitual en investigaciones sobre desarrollo celular) presentan problemas de definición, y aportamos una solución práctica a estos problemas. Finalmente, presentamos un algoritmo para predecir transciones entre estados sincronizados y desincronizados (por ejemplo, las transiciones entre sueño normal e insomnio, o entre funcionamiento cardiaco normal y un episodio de arritmia), con posibles aplicaciones en las ciencias médicas.&lt;/p&gt;
&lt;p&gt;La tesis está disponible, temporalmente &lt;a href="https://www.dropbox.com/sh/kg147e5x0o09ddl/AABvsbPApgMXJhBSQNnfqa1Ja?dl=0"&gt;aquí&lt;/a&gt;.&lt;/p&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Talk announcement: Ciencia y arte, enemigos íntimos (Festival Arte y Ciencia)</title><link href="https://pabrod.github.io/arte_y_ciencia-en.html" rel="alternate"></link><published>2020-03-09T10:25:40+01:00</published><updated>2020-03-09T10:25:40+01:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2020-03-09:/arte_y_ciencia-en.html</id><summary type="html">&lt;p&gt;Science and arts are often presented as opposite to each other, but are they? 10-11 March 2020, Planetario de Pamplona, Navarre, Spain.&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Title&lt;/h2&gt;
&lt;p&gt;Arte y ciencia, enemigos íntimos&lt;/p&gt;
&lt;p&gt;This talk will be given in Spanish.&lt;/p&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;Science and arts are often presented as opposite to each other, but are they?&lt;/p&gt;
&lt;p&gt;&lt;img alt="slides" src="images/2020-03/arte-y-ciencia.png"&gt;&lt;/p&gt;
&lt;p&gt;This talk will be part of the &lt;a href="https://www.unavarra.es/unidadculturacientifica/ciclo-arte-ciencia-y-tecnologia?opcion=1"&gt;Festival arte y ciencia&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Spacetime coordinates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;10-11 March. &lt;a href="https://www.pamplonetario.org/"&gt;Planetario de Pamplona&lt;/a&gt;, Navarra, Spain. Free access&lt;/li&gt;
&lt;/ul&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Visualization of a 3D Levi-Civita symbol</title><link href="https://pabrod.github.io/levi-civita-en.html" rel="alternate"></link><published>2019-12-08T16:37:24+01:00</published><updated>2019-12-08T16:37:24+01:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2019-12-08:/levi-civita-en.html</id><summary type="html">&lt;p&gt;Simple way of visualizing the structure of the Levi-Civita symbol&lt;/p&gt;</summary><content type="html">&lt;script type="text/x-mathjax-config"&gt;
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
&lt;/script&gt;

&lt;script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"&gt;
&lt;/script&gt;

&lt;p&gt;The &lt;a href="https://en.wikipedia.org/wiki/Levi-Civita_symbol"&gt;Levi-Civita symbol&lt;/a&gt; is that puzzling $\epsilon_{ijk}$ term that appears in the calculation of determinants and vector products. It has, thus, lots of applications in algebra, geometry, mechanics, electromagnetism, ... A (boring) definition is given in the textbox below.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;The value of $\epsilon_{ijk}$ goes as follows:&lt;/p&gt;
&lt;p&gt;It is $0$ if the value of &lt;strong&gt;any&lt;/strong&gt; index is repeated, such as in $ijk = 112$&lt;/p&gt;
&lt;p&gt;It is $1$ if the indices are $ijk \in123, 312, 231$&lt;/p&gt;
&lt;p&gt;It is $-1$ if the indices are $ijk \in 321, 132, 213$&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;I am interested in visualization. Unfortunately, the Levi-Civita symbol has three indices, $i$, $j$ and $k$, so we cannot represent it as a matrix or a vector. But, taking advantage of its discrete nature (it can only take 3 different values) we can create a "cubic matrix" to visualize it. This matrix contains $3 \times 3 \times 3$ cubes, each of them univocally identified by a triplet $ijk$, and the color tells us its value (grey for $0$, green for $1$, red for $-1$).&lt;/p&gt;
&lt;p&gt;That's what I did in a GeoGebra applet. I leave it here, just in case anyone finds it interesting. Click on the image to open an interactive version where the cube can be rotated.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.geogebra.org/m/fbtgkakj"&gt;&lt;img alt="Levi-Civita" src="images/2019-12/LeviCivita.png"&gt;&lt;/a&gt;&lt;/p&gt;</content><category term="Blog"></category><category term="math"></category><category term="GeoGebra"></category></entry><entry><title>Talk announcement: How software development shaped the way I write science (National eScience Symposium)</title><link href="https://pabrod.github.io/NLeSC_symp19-en.html" rel="alternate"></link><published>2019-11-17T16:28:38+01:00</published><updated>2019-11-17T16:28:38+01:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2019-11-17:/NLeSC_symp19-en.html</id><summary type="html">&lt;p&gt;How software development shaped the way I write science, 21 November 2019, National eScience Symposium 2019. Amsterdam&lt;/p&gt;</summary><content type="html">&lt;p&gt;A few months ago, I informally presented an earlier version of this talk at the &lt;a href="https://www.esciencecenter.nl/"&gt;Netherlands eScience Center&lt;/a&gt; (NLeSC). Two remarkable things happened after that:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Now I am an &lt;em&gt;eScience Engineer&lt;/em&gt; at NLeSC.&lt;/li&gt;
&lt;li&gt;They invited me to give the talk again. This time in a less informal setting: the &lt;a href="https://www.esciencesymposium2019.nl"&gt;National eScience Symposium&lt;/a&gt;, and in a less informal venue: the Ajax stadium&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Title&lt;/h2&gt;
&lt;p&gt;How software development shaped the way I write science&lt;/p&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;When we say that scientific papers are complex, we tend to think that their contents are complex. While this is true, there is much more: a paper itself is a complex form of communication. In this short talk I'll explain how my years in the industry of software development dramatically changed the way I write scientific publications.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.dropbox.com/s/97w42albhmujow9/Talk%20at%20Johan%20Cruijff%20-%20public.pptx?dl=0"&gt;&lt;img alt="slides" src="images/2019-11/cover.png"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Spacetime coordinates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;21 November. Johan Cruijff Arena, Amsterdam. &lt;a href="https://www.esciencesymposium2019.nl/page/608898"&gt;FAIR software session&lt;/a&gt;. Registration required&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Links&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Slides temporarily available &lt;a href="https://www.dropbox.com/s/97w42albhmujow9/Talk%20at%20Johan%20Cruijff%20-%20public.pptx?dl=0"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Key references&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;My research workflow, based on GitHub. Carl Boettiger. Available &lt;a href="https://www.carlboettiger.info/2012/05/06/research-workflow.html"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Wilson G, Aruliah DA, Brown CT, Chue Hong NP, Davis M, Guy RT, et al. Best Practices for Scientific Computing. Eisen JA, editor. PLoS Biol [Internet]. 2014 Jan 7. Available &lt;a href="http://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.1001745"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Galileo's instruments of credit. Telescopes, images, secrecy. Mario Biagioli.&lt;/li&gt;
&lt;li&gt;Rodríguez-Sánchez P. PabRod/rolldown. 2019. Available from: &lt;a href="https://doi.org/10.5281/zenodo.2591550"&gt;https://doi.org/10.5281/zenodo.2591550&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Rodríguez-Sánchez P, van Nes EH, Scheffer M. Climbing Escher’s stairs: a simple quasi-potential algorithm for weakly non-gradient systems. 2019 Mar 13. Available from: &lt;a href="http://arxiv.org/abs/1903.05615"&gt;http://arxiv.org/abs/1903.05615&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Seminar announcement: How software development shaped the way I write science (Netherlands eScience Center)</title><link href="https://pabrod.github.io/seminar-nesc-en.html" rel="alternate"></link><published>2019-08-19T15:30:00+02:00</published><updated>2019-08-19T15:30:00+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2019-08-19:/seminar-nesc-en.html</id><summary type="html">&lt;p&gt;How software development shaped the way I write science, 20 August 2019, Netherlands eScience Center. Amsterdam&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Title&lt;/h2&gt;
&lt;p&gt;How software development shaped the way I write science&lt;/p&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;When we say that scientific papers are complex, we tend to think that their contents are complex. While this is true, there is much more: a paper itself is a complex form of communication. In this short talk I'll explain how my years in the industry of software development dramatically changed the way I write scientific publications.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.dropbox.com/s/ngu2pb343fqd4mz/Talk%20at%20eScience%20-%20public.pptx?dl=0"&gt;&lt;img alt="slides" src="images/2019-08/cover.png"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Spacetime coordinates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;20 August 2019, 11:30-12:00 (local timezone)&lt;/li&gt;
&lt;li&gt;Netherlands eScience Center. Amsterdam. This is going to be a private meeting&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Links&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Slides temporarily available &lt;a href="https://www.dropbox.com/s/ngu2pb343fqd4mz/Talk%20at%20eScience%20-%20public.pptx?dl=0"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Key references&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;My research workflow, based on GitHub. Carl Boettiger. Available &lt;a href="https://www.carlboettiger.info/2012/05/06/research-workflow.html"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Wilson G, Aruliah DA, Brown CT, Chue Hong NP, Davis M, Guy RT, et al. Best Practices for Scientific Computing. Eisen JA, editor. PLoS Biol [Internet]. 2014 Jan 7. Available &lt;a href="http://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.1001745"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Galileo's instruments of credit. Telescopes, images, secrecy. Mario Biagioli.&lt;/li&gt;
&lt;li&gt;Rodríguez-Sánchez P. PabRod/rolldown. 2019. Available from: &lt;a href="https://doi.org/10.5281/zenodo.2591550"&gt;https://doi.org/10.5281/zenodo.2591550&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Rodríguez-Sánchez P, van Nes EH, Scheffer M. Climbing Escher’s stairs: a simple quasi-potential algorithm for weakly non-gradient systems. 2019 Mar 13. Available from: &lt;a href="http://arxiv.org/abs/1903.05615"&gt;http://arxiv.org/abs/1903.05615&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Preprint: Climbing Escher's ladder</title><link href="https://pabrod.github.io/quasipotentials-en.html" rel="alternate"></link><published>2019-04-19T09:50:08+02:00</published><updated>2019-04-19T09:50:08+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2019-04-19:/quasipotentials-en.html</id><summary type="html">&lt;p&gt;Announcement of the preprint of my second paper&lt;/p&gt;</summary><content type="html">&lt;p&gt;Contrary to the popular opinion, biological models are harder than physical ones. The latter tend to be linear, have conserved quantities, hamiltonians, and that kind of nice features. One of this nice features I particularly miss is scalar potentials. And apparently biologists miss them too.&lt;/p&gt;
&lt;p&gt;Potentials are often used in biology (often referred to as stability landscapes or ball-in-a-cup diagrams) as visual analogies to understand the properties of dynamical systems. Those diagrams have proven to be particularly useful to communicate complicated concepts from dynamical systems theory to non-expert audiences, such as bifurcation, basin of attraction or hysteresis. Unfortunately, when we try to use these pictures for multidimensional systems we find a subtle, albeit critical limitation: unless very restrictive conditions are met, potentials fail to exist.&lt;/p&gt;
&lt;p&gt;&lt;img alt="aew" src="images/2019-04/aew.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Our first challenge was to address the subtle reason a potential may fail to exist without using heavy mathematical weaponry. We found a surprisingly accurate analogy in the world of art, particularly in M.C. Escher's paintings of impossible objects. The second challenge was to provide, at least, a partial solution to the problem. We introduced a simple and efficient algorithm that takes into account the abovementioned limitations, providing the best quasi-potential candidate plus an error map indicating the regions of the phase space where it is safe to use it.&lt;/p&gt;
&lt;p&gt;The title of this preprint is &lt;a href="https://arxiv.org/abs/1903.05615"&gt;&lt;em&gt;Climbing Escher's stairs: a way to approximate stability landscapes in multidimensional systems&lt;/em&gt;&lt;/a&gt;. The document is freely available in &lt;a href="https://arxiv.org/abs/1903.05615"&gt;arXiv&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Together with the article, and fueling my personal obsession with collaboration and reproducibility, I wrote and published an R package called &lt;a href="https://github.com/PabRod/rolldown"&gt;rolldown&lt;/a&gt; (my first one!) implementing the described algorithm.&lt;/p&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;Stability landscapes are useful for understanding the properties of dynamical systems. These landscapes can be calculated from the system's dynamical equations using the physical concept of scalar potential. Unfortunately, for most biological systems with two or more state variables such potentials do not exist. Here we use an analogy with art to provide an accessible explanation of why this happens. Additionally, we introduce a numerical method for decomposing differential equations into two terms: the gradient term that has an associated potential, and the non-gradient term that lacks it. In regions of the state space where the magnitude of the non-gradient term is small compared to the gradient part, we use the gradient term to approximate  the potential as quasi-potential. The non-gradient to gradient ratio can be used to estimate the local error introduced by our approximation. Both the algorithm and a ready-to-use implementation in the form of an R package are provided.&lt;/p&gt;
&lt;h2&gt;Authors&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.sparcs-center.org/about-us/staff-contacts/pablo-rodriguez.html"&gt;Pablo Rodríguez-Sánchez&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.sparcs-center.org/about-us/staff-contacts/egbert-van-nes.html"&gt;Egbert H. van Nes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.sparcs-center.org/about-us/staff-contacts/marten-scheffer.html"&gt;Marten Scheffer&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;All from Wageningen University and Research.&lt;/p&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Python or R? Why not both?</title><link href="https://pabrod.github.io/PyR-en.html" rel="alternate"></link><published>2019-03-22T10:50:31+01:00</published><updated>2019-03-22T10:50:31+01:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2019-03-22:/PyR-en.html</id><summary type="html">&lt;p&gt;How to use Python code inside R&lt;/p&gt;</summary><content type="html">&lt;script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async&gt;&lt;/script&gt;

&lt;p&gt;&lt;em&gt;Python&lt;/em&gt; and &lt;em&gt;R&lt;/em&gt;. They are two of the most popular programming languages
for science. They are both free, both of them have a strong user
community and both of them work pretty well.&lt;/p&gt;
&lt;p&gt;Personally, I find &lt;em&gt;Python&lt;/em&gt; way more intuitive than &lt;em&gt;R&lt;/em&gt; (at least for
people who, like me, have a classical mathematics background). Thinking
in terms of data frames is great when you work with statistical data,
but it gets a bit annoying when you are more interested in analysis. To
uneven the score even more, &lt;em&gt;Python's&lt;/em&gt; libraries like &lt;em&gt;NumPy&lt;/em&gt;, &lt;em&gt;SciPy&lt;/em&gt;,
&lt;em&gt;SimPy&lt;/em&gt; and &lt;em&gt;Matplotlib&lt;/em&gt; are the perfect toolbox for anyone doing
mathematical research of any kind.&lt;/p&gt;
&lt;p&gt;But... I chose &lt;em&gt;R&lt;/em&gt;. Why?&lt;/p&gt;
&lt;p&gt;There is only one reason for doing so: &lt;em&gt;knitr&lt;/em&gt;[1]. &lt;em&gt;knitr&lt;/em&gt; is a package
that turns a combination of text &lt;strong&gt;and code&lt;/strong&gt; (the &lt;em&gt;RMarkdown&lt;/em&gt; file)
into almost any format of human readable text, including a &lt;em&gt;pdf&lt;/em&gt; report,
slides, or a blog page like &lt;a href="https://github.com/PabRod/pabrod.github.io-src/blob/master/auxs/Rmd/2019-03-22%20PyR.Rmd"&gt;the one you are reading now&lt;/a&gt;. The interesting
point is the integration of the code with the text. This means that an
&lt;em&gt;RMarkdown&lt;/em&gt; document is not passive. This allows one to write papers
that, quite literally, recalculate themselves any time needed. &lt;em&gt;knitr&lt;/em&gt;,
combined with research code structured as an &lt;em&gt;R&lt;/em&gt; package, is clearly my
favourite way of writing research. The package structure keeps my code
tidy and tested, and &lt;em&gt;knitr&lt;/em&gt; allows me to do all and the figures the
writing in a single file. The result is a rock-solid, reproducible
output. Let me put it like this: &lt;em&gt;knitr&lt;/em&gt; is like &lt;em&gt;LaTeX&lt;/em&gt; on steroids![2]&lt;/p&gt;
&lt;p&gt;But... I keep finding &lt;em&gt;R&lt;/em&gt; annoying. A few days ago, after looking for
hours for a nice way of ploting phase planes, I gave up. All the
possibilities I found were terribly ugly. I had to go back to &lt;em&gt;Python's&lt;/em&gt;
&lt;em&gt;Matplotlib&lt;/em&gt; and its function &lt;em&gt;streamplot&lt;/em&gt;. See for yourself:&lt;/p&gt;
&lt;p&gt;With &lt;em&gt;R&lt;/em&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img alt="with-r" src="images/2019-03/phase-plot-1.png"&gt;&lt;/p&gt;
&lt;p&gt;With &lt;em&gt;Python&lt;/em&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img alt="with-py" src="images/2019-03/phase-plotPy-1.png"&gt;&lt;/p&gt;
&lt;p&gt;After a bit of googling, I found an &lt;em&gt;R&lt;/em&gt; library called &lt;em&gt;reticulate&lt;/em&gt; that
allows to run &lt;em&gt;Python&lt;/em&gt; code from inside &lt;em&gt;R&lt;/em&gt;. If this works (I thought) I
can keep the best of both approaches! And, so far, it works flawlessly!&lt;/p&gt;
&lt;h2&gt;How to do it&lt;/h2&gt;
&lt;p&gt;First of all, &lt;em&gt;R&lt;/em&gt; and &lt;em&gt;Python&lt;/em&gt; are obviously reequired. &lt;em&gt;reticulate&lt;/em&gt; can
be installed and loaded as usual in &lt;em&gt;R&lt;/em&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;install.packages(&amp;quot;reticulate&amp;quot;)&lt;/span&gt;
&lt;span class="err"&gt;library(reticulate)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;For &lt;a href="https://community.rstudio.com/t/matplotlib-inline-plots-with-reticulate-on-rstudio-server/16357"&gt;some
reason&lt;/a&gt;
I still don't fully understand, I had to add these two lines to make
&lt;em&gt;Matplotlib&lt;/em&gt; work properly.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;matplotlib&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;import&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;matplotlib&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;convert&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;matplotlib&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nf"&gt;use&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Agg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now, we can insert python chunks in &lt;em&gt;Rmarkdown&lt;/em&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;```&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;
&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="kp"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="err"&gt;```&lt;/span&gt;

&lt;span class="c1"&gt;## 0.707106781187&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Interaction&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;reticulate&lt;/em&gt; works creating two different sessions, one of &lt;em&gt;R&lt;/em&gt; and
another of &lt;em&gt;Python&lt;/em&gt;. In order to unleash all the power of this
combination, we need a way of passing variables between both sessions.
This is done via the dataframe &lt;code&gt;py&lt;/code&gt;. See examples below:&lt;/p&gt;
&lt;h3&gt;From &lt;em&gt;R&lt;/em&gt; to &lt;em&gt;Python&lt;/em&gt;&lt;/h3&gt;
&lt;p&gt;Create a variable and store it as a field of &lt;code&gt;py&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;```{r}&lt;/span&gt;
&lt;span class="n"&gt;py$foo &amp;lt;- &amp;quot;Hi!&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;```&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The variable will be available in the &lt;em&gt;Python&lt;/em&gt; session:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;```&lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;```&lt;/span&gt;

&lt;span class="o"&gt;##&lt;/span&gt; &lt;span class="n"&gt;Hi&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;From &lt;em&gt;Python&lt;/em&gt; to &lt;em&gt;R&lt;/em&gt;&lt;/h3&gt;
&lt;p&gt;Create a variable inside the &lt;em&gt;Python&lt;/em&gt; session:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;```{python}&lt;/span&gt;
&lt;span class="err"&gt;bar = &amp;quot;How are you?&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;```&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The variable will be available as a field of the dataframe &lt;code&gt;py&lt;/code&gt; in the
&lt;em&gt;R&lt;/em&gt; session:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;```&lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;py$bar&lt;/span&gt;
&lt;span class="o"&gt;```&lt;/span&gt;

&lt;span class="o"&gt;##&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;How are you?&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This entry appears in &lt;a href="https://www.r-bloggers.com"&gt;R-bloggers.com&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;[1] Actually, there is a second (and less important) reason: &lt;em&gt;Shiny&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;[2] It is true that &lt;em&gt;Python&lt;/em&gt; also has &lt;em&gt;Jupyter&lt;/em&gt; for reproducible
research, but the results are just not as neat as with &lt;em&gt;R&lt;/em&gt;.&lt;/p&gt;</content><category term="Blog"></category><category term="math"></category><category term="R"></category><category term="Python"></category></entry><entry><title>Animations in R</title><link href="https://pabrod.github.io/animations-r-en.html" rel="alternate"></link><published>2018-12-02T14:22:33+01:00</published><updated>2018-12-02T14:22:33+01:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-12-02:/animations-r-en.html</id><summary type="html">&lt;p&gt;How to make animations in R using ggplot2 and gganimate&lt;/p&gt;</summary><content type="html">&lt;script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async&gt;&lt;/script&gt;

&lt;p&gt;I've recently discovered the package &lt;em&gt;gganimate&lt;/em&gt; thanks to this
&lt;a href="http://blog.schochastics.net/post/beautiful-chaos-the-double-pendulum/"&gt;brilliant
example&lt;/a&gt;.
I've been playing with the package during this weekend, and I created
some examples that I spread through
&lt;a href="https://twitter.com/DonMostrenco/status/1068791278173908992"&gt;Twitter&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Some Twitter users showed interest in knowing more. I hope this short
tutorial can satisfy them.&lt;/p&gt;
&lt;h2&gt;Libraries used&lt;/h2&gt;
&lt;p&gt;We're going to need the following libraries:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="c1"&gt;# Numerical&lt;/span&gt;
    &lt;span class="n"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pracma&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# To calculate the Taylor polynomials&lt;/span&gt;
    &lt;span class="n"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# For using melt&lt;/span&gt;

    &lt;span class="c1"&gt;# Display&lt;/span&gt;
    &lt;span class="n"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ggplot2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# For plotting&lt;/span&gt;
    &lt;span class="n"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ggthemes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# Also for plotting&lt;/span&gt;
    &lt;span class="n"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gganimate&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# For animating. Install using devtools::install_github(&amp;#39;thomasp85/gganimate&amp;#39;)&lt;/span&gt;
    &lt;span class="n"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kableExtra&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# To display nice tables&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Animating a moving particle&lt;/h2&gt;
&lt;p&gt;Here we'll generate a moving particle. First, we need the positions in
time. In our case, the dynamical equations will be given by:&lt;/p&gt;
&lt;p&gt;$$ \begin{cases} x(t) = cos(t) \\ y(t) = sin(2t) \end{cases}$$&lt;/p&gt;
&lt;p&gt;So we generate the series and store them in a dataframe:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="kc"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;length.out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;xs&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;ys&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;particle&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;data.frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ys&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The code for generating the animation follows a very similar syntax to
&lt;em&gt;ggplot&lt;/em&gt;. In this case, we indicate that the values of &lt;em&gt;ts&lt;/em&gt; should be
used as the transition time.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;    ggplot(data = particle) +&lt;/span&gt;
&lt;span class="err"&gt;      geom_point(aes(x = xs, y = ys), col = &amp;#39;red&amp;#39;) + # Generate the plot&lt;/span&gt;
&lt;span class="err"&gt;      theme_tufte() + # Make ...&lt;/span&gt;
&lt;span class="err"&gt;      labs(x = &amp;#39;x&amp;#39;, y = &amp;#39;y&amp;#39;) + # ... it ...&lt;/span&gt;
&lt;span class="err"&gt;      scale_y_continuous(limits = c(-2, 2)) + # ... look ...&lt;/span&gt;
&lt;span class="err"&gt;      guides(col = FALSE) + # ... pretty.&lt;/span&gt;
&lt;span class="err"&gt;      transition_time(ts) + # And animate!&lt;/span&gt;
&lt;span class="err"&gt;      ease_aes(&amp;#39;linear&amp;#39;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="a" src="images/2018-12/Movement-1.gif"&gt;&lt;/p&gt;
&lt;h2&gt;Animating a Taylor series&lt;/h2&gt;
&lt;p&gt;Let's see now a more complex example. Our purpose is to explore Taylor
polynomials of different degrees approximating the function&lt;/p&gt;
&lt;p&gt;$$f(x) = cos(\frac{3x}{2}) e^{-x} $$&lt;/p&gt;
&lt;p&gt;around a given point.&lt;/p&gt;
&lt;p&gt;Thus, we begin creating the function:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nf"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In this case, we want to compare how good is the performance of Taylor
polynomials of different orders. The data we have to generate is a bit
more complex than before.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="n"&gt;xs&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1500&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# Values of x&lt;/span&gt;
    &lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="c1"&gt;# Value of x where the Taylor series will be centered&lt;/span&gt;
    &lt;span class="n"&gt;ys&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nrow&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xs&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;ncol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;# Extract Taylor polynomials of orders 0 to 8&lt;/span&gt;
      &lt;span class="n"&gt;order&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="c1"&gt;# Indexes have to be positive, but first order is 0&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;order&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;# A Taylor polynomial of order zero is just...&lt;/span&gt;
        &lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;[,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# ... a constant function&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;taylor_coefs&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;taylor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;order&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# Get polynomial&lt;/span&gt;
        &lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;[,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;polyval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;taylor_coefs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# Evaluate polynomial&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;# Rewrite as dataframe&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;colnames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;melt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;cbind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xs&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;colnames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ys&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;xs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;f&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The resulting dataframe is a collection of polynomials of different
orders evaluated at each point in &lt;em&gt;xs&lt;/em&gt;. Additionally, we added the
values of the original function &lt;em&gt;f(x)&lt;/em&gt;, also at each point:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th align="left"&gt;order&lt;/th&gt;
&lt;th align="right"&gt;ys&lt;/th&gt;
&lt;th align="right"&gt;xs&lt;/th&gt;
&lt;th align="right"&gt;f&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td align="left"&gt;0&lt;/td&gt;
&lt;td align="right"&gt;0.0260228&lt;/td&gt;
&lt;td align="right"&gt;-2.000000&lt;/td&gt;
&lt;td align="right"&gt;-7.315110&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td align="left"&gt;0&lt;/td&gt;
&lt;td align="right"&gt;0.0260228&lt;/td&gt;
&lt;td align="right"&gt;-1.994474&lt;/td&gt;
&lt;td align="right"&gt;-7.265955&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td align="left"&gt;0&lt;/td&gt;
&lt;td align="right"&gt;0.0260228&lt;/td&gt;
&lt;td align="right"&gt;-1.988948&lt;/td&gt;
&lt;td align="right"&gt;-7.216622&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td align="left"&gt;0&lt;/td&gt;
&lt;td align="right"&gt;0.0260228&lt;/td&gt;
&lt;td align="right"&gt;-1.983423&lt;/td&gt;
&lt;td align="right"&gt;-7.167120&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td align="left"&gt;0&lt;/td&gt;
&lt;td align="right"&gt;0.0260228&lt;/td&gt;
&lt;td align="right"&gt;-1.977897&lt;/td&gt;
&lt;td align="right"&gt;-7.117454&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td align="left"&gt;0&lt;/td&gt;
&lt;td align="right"&gt;0.0260228&lt;/td&gt;
&lt;td align="right"&gt;-1.972371&lt;/td&gt;
&lt;td align="right"&gt;-7.067632&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;A static plot will look like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;    ggplot(data = df) +&lt;/span&gt;
&lt;span class="err"&gt;      geom_point(aes(x = xs, y = ys, col = order)) + # Generate basic plot&lt;/span&gt;
&lt;span class="err"&gt;      geom_point(aes(x = xs, y = f)) + # Plot also original function&lt;/span&gt;
&lt;span class="err"&gt;      geom_point(aes(x = x0, y = f(x0)), col = &amp;#39;black&amp;#39;, size = 5) + # Remark initial point&lt;/span&gt;
&lt;span class="err"&gt;      theme_tufte() + # Make it ...&lt;/span&gt;
&lt;span class="err"&gt;      labs(x = &amp;#39;x&amp;#39;, y = &amp;#39;y&amp;#39;) + # ... look ...&lt;/span&gt;
&lt;span class="err"&gt;      scale_y_continuous(limits = c(-2, 2)) # ... pretty.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="a" src="images/2018-12/Plot-static-1.png"&gt;&lt;/p&gt;
&lt;p&gt;In order to animate it, now we will use the command
&lt;em&gt;transition_states&lt;/em&gt;, using &lt;em&gt;order&lt;/em&gt; (the order of the Taylor polynomial)
as the animation parameter. The parameters &lt;em&gt;transition_length&lt;/em&gt; and
&lt;em&gt;state_length&lt;/em&gt; control how much time each state stays in screen, and
how long the transition between states should look.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;    ggplot(data = df) +&lt;/span&gt;
&lt;span class="err"&gt;      geom_point(aes(x = xs, y = ys), col = &amp;#39;red&amp;#39;) + # Add basic plot&lt;/span&gt;
&lt;span class="err"&gt;      geom_point(aes(x = xs, y = f)) + # Plot also original function&lt;/span&gt;
&lt;span class="err"&gt;      geom_point(aes(x = x0, y = f(x0)), col = &amp;#39;red&amp;#39;, size = 5) + # Remark initial point&lt;/span&gt;
&lt;span class="err"&gt;      theme_tufte() + # Make ...&lt;/span&gt;
&lt;span class="err"&gt;      labs(x = &amp;#39;x&amp;#39;, y = &amp;#39;y&amp;#39;) + # ... it ...&lt;/span&gt;
&lt;span class="err"&gt;      scale_y_continuous(limits = c(-2, 2)) + # ... look ...&lt;/span&gt;
&lt;span class="err"&gt;      guides(col = FALSE) + # ... pretty.&lt;/span&gt;
&lt;span class="err"&gt;      transition_states(order, transition_length = 1, state_length = 0.5) + # And animate!&lt;/span&gt;
&lt;span class="err"&gt;      ease_aes(&amp;#39;linear&amp;#39;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="a" src="images/2018-12/Plot-animated-1.gif"&gt;&lt;/p&gt;
&lt;p&gt;The result could not look nicer!&lt;/p&gt;
&lt;p&gt;This entry appears in &lt;a href="https://www.r-bloggers.com"&gt;R-bloggers.com&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;PS: If you liked this post, &lt;a href="https://www.geogebra.org/m/CeW2gCzH"&gt;this
visualization&lt;/a&gt; I made in &lt;em&gt;GeoGebra&lt;/em&gt;
some time ago may also be of your interest.&lt;/p&gt;</content><category term="Blog"></category><category term="math"></category><category term="R"></category></entry><entry><title>The spectrum of my personal accountancy</title><link href="https://pabrod.github.io/spectrum-accountancy-en.html" rel="alternate"></link><published>2018-11-28T13:54:29+01:00</published><updated>2018-11-28T13:54:29+01:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-11-28:/spectrum-accountancy-en.html</id><summary type="html">&lt;p&gt;Application of Fourier analysis to a personal accountancy timeseries&lt;/p&gt;</summary><content type="html">&lt;script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async&gt;&lt;/script&gt;

&lt;p&gt;Since year 2012, I keep and maintain a &lt;em&gt;.csv&lt;/em&gt; file containing
information about my bank accounts. The most relevant data is the time
series of the total amount of money vs. date. The table below shows a
small subset of this data:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th align="left"&gt;Date&lt;/th&gt;
&lt;th align="right"&gt;Total&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td align="left"&gt;2012-09-26&lt;/td&gt;
&lt;td align="right"&gt;641.52&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td align="left"&gt;2012-09-24&lt;/td&gt;
&lt;td align="right"&gt;703.52&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td align="left"&gt;2012-09-22&lt;/td&gt;
&lt;td align="right"&gt;723.52&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td align="left"&gt;2012-09-19&lt;/td&gt;
&lt;td align="right"&gt;755.52&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td align="left"&gt;2012-09-18&lt;/td&gt;
&lt;td align="right"&gt;765.52&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;When plotted, the data looks as noisy as the example on the figure below. The most noticeable regularity is the periodic increment at the end of each month, corresponding with the &lt;strong&gt;pay day&lt;/strong&gt;... followed by a big expenditure corresponding to paying the &lt;strong&gt;rent&lt;/strong&gt;. Notice also the higher pay in late June, corresponding to the summer extra salary that is customarily applied in several countries. The timeseries looks irregular, but there is some clear periodical component on it.&lt;/p&gt;
&lt;p&gt;&lt;img alt="a" src="images/2018-11/Plot-data-1.png"&gt;&lt;/p&gt;
&lt;p&gt;I know that the Fourier transform of a continuous timeseries is the perfect tool for spotting underlying periodicities. But my timeseries is uneven and discontinous. How can we fix this?&lt;/p&gt;
&lt;h2&gt;First step: Interpolation&lt;/h2&gt;
&lt;p&gt;The first problem, unevenness of data, can be solved by good old interpolation methods. The only tricky part here is that our &lt;em&gt;x&lt;/em&gt; coordinates are dates, so it is advisable to use &lt;em&gt;lubridate&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;I used the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dplyr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nf"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lubridate&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;first_day&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;last_day&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Add a column with relative day as an integer&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;mutate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Day_index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;as.numeric&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Date&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;first_day&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;# Create the time vector used for interpolation&lt;/span&gt;
&lt;span class="n"&gt;all_days&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;first_day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;last_day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;all_indices&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nf"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;all_days&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;daily_total&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;approx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Day_index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Total&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;all_indices&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;yright&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Total&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Second step: Fourier transform&lt;/h2&gt;
&lt;p&gt;For discrete, evenly spaced timeseries as the one we have after interpolation, fast Fourier transform can be used to estimate dominant frequencies. The fast Fourier transform or &lt;em&gt;FFT&lt;/em&gt; is defined as a function of an integer parameter &lt;em&gt;k&lt;/em&gt; and a set of &lt;em&gt;N&lt;/em&gt; complex numbers {&lt;em&gt;x&lt;/em&gt;&lt;sub&gt;0&lt;/sub&gt;, &lt;em&gt;x&lt;/em&gt;&lt;sub&gt;1&lt;/sub&gt;, ...&lt;em&gt;x&lt;/em&gt;&lt;sub&gt;&lt;em&gt;N&lt;/em&gt; − 1&lt;/sub&gt;}.&lt;/p&gt;
&lt;p&gt;The definition goes as follows:&lt;/p&gt;
&lt;p&gt;$$
X_k = FFT [ k; \lbrace x_n \rbrace] \equiv  \sum_{n=0}^{N-1} x_n\cdot e^{-i 2 \pi k \frac{n}{N}}
$$&lt;/p&gt;
&lt;p&gt;and the inverse:&lt;/p&gt;
&lt;p&gt;$$
x_n = FFT^{-1} [ n; \lbrace X_k \rbrace] \equiv  \frac{1}{N}\sum_{k=0}^{N-1} X_k \cdot  e^{i 2 \pi k \frac{n}{N}}
$$&lt;/p&gt;
&lt;p&gt;The &lt;em&gt;FFT&lt;/em&gt; can be used to estimate the spectrum of a signal. While doing this, it is important to note that &lt;em&gt;n&lt;/em&gt; and &lt;em&gt;k&lt;/em&gt; are unit-less vector indices. In order to link those indices with physical quantities as time and frequency, we could notice that:&lt;/p&gt;
&lt;p&gt;$$
x_n = x(n \cdot \Delta t) \equiv x(t_n)
$$&lt;/p&gt;
&lt;p&gt;where &lt;em&gt;Δ&lt;/em&gt;&lt;em&gt;t&lt;/em&gt; is the sampling period. If we take a number &lt;em&gt;N&lt;/em&gt; of samples, the final sample time should be:&lt;/p&gt;
&lt;p&gt;$$
t_{end} = N \cdot \Delta t \equiv t_N
$$&lt;/p&gt;
&lt;p&gt;Going to our first equation with all this in mind, we have:&lt;/p&gt;
&lt;p&gt;$$
X_k \equiv \\
\sum_{n=0}^{N-1} x_n \cdot e^{-i 2 \pi k \frac{n}{N}} = \\
\sum_{n=0}^{N-1} x(n \cdot \Delta t) \cdot e^{-i 2 \pi k \frac{n \cdot \Delta t}{t_{end}}} = \\
\sum_{t_n=0}^{t_{end}-\Delta t} x(t_n) \cdot e^{-i 2 \pi k \frac{t_n}{t_{end}}} = \\
\sum_{t_n=0}^{t_{end}-\Delta t} x(t_n) \cdot e^{-i \frac{2 \pi k}{t_{end}} t_n} = \\
\sum_{t_n=0}^{t_{end}-\Delta t} x(t_n) \cdot e^{-i \omega_k t_n}
$$&lt;/p&gt;
&lt;p&gt;so, the link between the indices &lt;em&gt;k&lt;/em&gt; and the corresponding physical frequencies &lt;em&gt;ω&lt;/em&gt;&lt;sub&gt;&lt;em&gt;k&lt;/em&gt;&lt;/sub&gt; is given by:&lt;/p&gt;
&lt;p&gt;$$
\omega_k = \frac{2 \pi}{t_{end}} k
$$&lt;/p&gt;
&lt;p&gt;We just added units (and thus, physical) significance to the indexes &lt;em&gt;k&lt;/em&gt; and &lt;em&gt;n&lt;/em&gt;!&lt;/p&gt;
&lt;p&gt;The (quite primitive) code I used for doing this is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="n"&gt;fft_spectrum&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;as.freq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="c1"&gt;# Translate k indices into frequencies&lt;/span&gt;
      &lt;span class="n"&gt;tEnd&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;tail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;fs&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nf"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="m"&gt;-1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;tEnd&lt;/span&gt; &lt;span class="c1"&gt;# In T^-1 units (typically Hz, if the time is in seconds)&lt;/span&gt;

      &lt;span class="c1"&gt;#Perform fast Fourier transform&lt;/span&gt;
      &lt;span class="n"&gt;Xk&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;Mod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;fft&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

      &lt;span class="nf"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;as.freq&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;# Use frequencies&lt;/span&gt;
        &lt;span class="nf"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Xk&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Xk&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="n"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;# Use periods&lt;/span&gt;
        &lt;span class="nf"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;T&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;fs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Xk&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Xk&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Results&lt;/h2&gt;
&lt;p&gt;After applying the two algorithms described above I find the following distribution of the relative lengths of each period:&lt;/p&gt;
&lt;p&gt;&lt;img alt="b" src="images/2018-11/Frequencies-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Note that the strengths corresponding to periods of &lt;em&gt;30&lt;/em&gt; and &lt;em&gt;31&lt;/em&gt; days are higher than their neighbors, corresponding to pay-days and monthly payments. Even my very basic algorithm could see it!&lt;/p&gt;
&lt;p&gt;&lt;em&gt;PS: I removed several details, plus trimmed both vertical and horizontal scales. I did this in order to keep my privacy. After all, the FFT is an invertible operation!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;This entry appears in &lt;a href="https://www.r-bloggers.com"&gt;R-bloggers.com&lt;/a&gt; &lt;/p&gt;</content><category term="Blog"></category><category term="math"></category><category term="R"></category></entry><entry><title>Interactive applet: daylight saving time in Spain</title><link href="https://pabrod.github.io/daylight-saving-en.html" rel="alternate"></link><published>2018-09-03T13:51:47+02:00</published><updated>2018-09-03T13:51:47+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-09-03:/daylight-saving-en.html</id><summary type="html">&lt;p&gt;A visualization applet&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;This is a translation of the essay "Interactivo: ¿Cómo me afecta el cambio de hora?", originally published &lt;a href="https://fuga.naukas.com/2018/09/02/interactivo-como-me-afecta-el-cambio-de-hora/"&gt;here&lt;/a&gt; in Spanish.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The possibility of cancelling daylight saving time in the European Union has been one of the highlights of the week.&lt;/p&gt;
&lt;p&gt;In order to shed some light over this (surprisingly) controversial topic, I made this interactive visualization. It allows to predict the daylight hours in several Spanish cities and towns, under the different possible scenarios.&lt;/p&gt;
&lt;p&gt;To play with it, follow &lt;a href="https://pabrod.shinyapps.io/cambio-de-hora/"&gt;this link&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The code is freely available &lt;a href="https://github.com/PabRod/cambio-de-hora"&gt;on GitHub&lt;/a&gt;.&lt;/p&gt;</content><category term="Blog"></category><category term="physics"></category></entry><entry><title>Seminar announcement: An example of reproducible research (University College Cork)</title><link href="https://pabrod.github.io/seminar-cork-en.html" rel="alternate"></link><published>2018-08-21T14:52:25+02:00</published><updated>2018-08-21T14:52:25+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-08-21:/seminar-cork-en.html</id><summary type="html">&lt;p&gt;An example of reproducible research, 29 August 2018, University College Cork&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Title&lt;/h2&gt;
&lt;p&gt;Neutral competition and chaos. An example of reproducible research&lt;/p&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;Have you ever thought of how many lines of scientific code are hidden in researcher's hard drives? Have you ever tried to reproduce a complicated algorithm described only with words on a scientific publication? In this talk, I will use my recently released paper as a case study to briefly review the technical possibilities and difficulties regarding publishing, citing and maintaining scientific code.&lt;/p&gt;
&lt;h2&gt;Spacetime coordinates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;29 August 2018, 12:15-12:35 (local timezone)&lt;/li&gt;
&lt;li&gt;Aula Maxima. University College Cork. Ireland.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Key references&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Rodríguez-Sánchez P, van Nes EH, Scheffer M. Neutral competition boosts chaos in food webs. Preprint available in &lt;a href="http://arxiv.org/abs/1807.06901"&gt;arXiv&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Rodríguez-Sánchez P. PabRod/Chaos-and-neutrality: Analysis script for “Neutral competition boosts chaos in food webs”. 2018. Available &lt;a href="https://doi.org/10.5281/zenodo.1319590"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Wilson G, Aruliah DA, Brown CT, Chue Hong NP, Davis M, Guy RT, et al. Best Practices for Scientific Computing. Eisen JA, editor. PLoS Biol [Internet]. 2014 Jan 7. Available &lt;a href="http://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.1001745"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Links&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Slides will be temporarily available &lt;a href="https://www.dropbox.com/s/rb90g1qky5v6ocx/An%20example%20of%20reproducible%20research.pptx?dl=0"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.criticsitn.eu/wp/?page_id=1813"&gt;Workshop's website&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Preprint: Neutral competition boosts chaos in food webs</title><link href="https://pabrod.github.io/chaos-neutrality-en.html" rel="alternate"></link><published>2018-07-19T21:10:16+02:00</published><updated>2018-07-19T21:10:16+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-07-19:/chaos-neutrality-en.html</id><summary type="html">&lt;p&gt;Announcement of the preprint of my first paper&lt;/p&gt;</summary><content type="html">&lt;p&gt;In the early days of quantum theory, all Nobel prizes awarded to researchers working on atomic structure fell under the category of chemistry. I think it was Ernest Rutherford who joked about his instantaneous transformation from a physicist into a chemist when he received the chemistry Nobel prize in 1908.&lt;/p&gt;
&lt;p&gt;I'm certainly not even comparable to the great New Zealander. But I'm also suffering a transformation, from a physicist into a biologist. Unfortunately, mine is not instantaneous. It took literally years of work to publish my first preprint. The title is &lt;a href="https://arxiv.org/abs/1807.06901"&gt;&lt;em&gt;Neutral competition boosts chaos in food webs&lt;/em&gt;&lt;/a&gt;, and it's about population dynamics.&lt;/p&gt;
&lt;p&gt;The document is available in &lt;a href="https://arxiv.org/abs/1807.06901"&gt;arXiv&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Those who, like me, are obsessed with reproducibility, will appreciate knowing that the code I wrote for my analysis is fully available in &lt;a href="https://github.com/PabRod/Chaos-and-neutrality"&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;Near-neutrality of competition has been proposed to facilitate coexistence of species because it slows down competitive exclusion, thus making it easier for equalizing mechanisms to maintain diverse communities. An unrelated line of work has shown that chaos can promote coexistence of many species in super-saturated communities. By analyzing a set of numerically simulated food webs, here we link those previously unrelated findings. We show that near-neutrality of competition at the prey's trophic level, in the presence of interactions with natural enemies, increases the chances of developing chaotic dynamics. Our results suggest that near-neutrality may promote biodiversity in two ways: through reducing the rates of competitive displacement and through promoting non-equilibrium dynamics.&lt;/p&gt;
&lt;h2&gt;Authors&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.sparcs-center.org/about-us/staff-contacts/pablo-rodriguez.html"&gt;Pablo Rodríguez-Sánchez&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.sparcs-center.org/about-us/staff-contacts/egbert-van-nes.html"&gt;Egbert H. van Nes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.sparcs-center.org/about-us/staff-contacts/marten-scheffer.html"&gt;Marten Scheffer&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;All from Wageningen University and Research.&lt;/p&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Seminar announcement: Competition, diversity and the benefits of chaos (Imperial College London)</title><link href="https://pabrod.github.io/seminar-macsim-en.html" rel="alternate"></link><published>2018-07-04T09:50:14+02:00</published><updated>2018-07-04T09:50:14+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-07-04:/seminar-macsim-en.html</id><summary type="html">&lt;p&gt;Invasive species: a mathematician among biologists, 12 July 2018, Imperial College London&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Event&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://www.criticsitn.eu/wp/?page_id=2201"&gt;Critical transitions, stability and resilience in nature, technology and society: Innovations and Applications&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Title&lt;/h2&gt;
&lt;p&gt;Competition, diversity and the benefits of chaos&lt;/p&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;In this talk we'll explore how chaos can be the driver not only of unpredictability and disorder, but also of diversity inside an ecosystem. The analysis performed can be easily adapted and generalized to different kinds of competition systems, both inside and outside biology.&lt;/p&gt;
&lt;h2&gt;Key references&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Huisman J, Weissing FJ. Biodiversity of plankton by species oscillations and chaos. Nature [Internet]. 1999 Nov 25;402(6760):407–10. Available &lt;a href="http://www.nature.com/articles/46540"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Dakos V, Beninca E, van Nes EH, Philippart CJM, Scheffer M, Huisman J. Interannual variability in species composition explained as seasonally entrained chaos. Proc R Soc B Biol Sci. 2009 Aug 22 ;276(1669):2871–80. Available &lt;a href="http://rspb.royalsocietypublishing.org/cgi/doi/10.1098/rspb.2009.0584"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Spacetime coordinates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;12 July 2018, 9:30-17:00 (local timezone)&lt;/li&gt;
&lt;li&gt;Clore Lecture Theatre. Department of Mathematics, Imperial College London. South Kensington Campus, Huxley Building, 180 Queen's Gate, Kensington, London SW7 2AZ&lt;/li&gt;
&lt;/ul&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Things I've learned working in a multidisciplinary group</title><link href="https://pabrod.github.io/multidisciplinary-en.html" rel="alternate"></link><published>2018-06-12T16:04:02+02:00</published><updated>2018-06-12T16:04:02+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-06-12:/multidisciplinary-en.html</id><summary type="html">&lt;p&gt;I work as a mathematician in an... aquatic ecology department!&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;This is a translation of the essay "Cosas que he aprendido trabajando en un grupo multidisciplinar", originally published &lt;a href="http://fuga.naukas.com/2018/06/12/grupo-multidisciplinar"&gt;here&lt;/a&gt; in Spanish.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;As some of you already know, I'm a physicist. Despite that, I work as a mathematician in an... aquatic ecology department! This situation, apart from creating an identity crisis on me, makes me spend quite some time thinking about the diffuse and popular concept of "multidisciplinarity".&lt;/p&gt;
&lt;p&gt;The underlying idea behind multidisciplinarity is that it is not possible to bundle knowledge in fixed categories, mostly motivated by academical tradition. The borders between disciplines are diffuse. Two clear examples: no one can trace a solid line between physics and mathematics (where does mechanics end and analysis starts?), nor between physics and chemistry (is molecular structure chemistry or quantum mechanics?). An ideal multidisciplinary team contains experts from different fields, increasing thus the reach of the problems that can be addressed. In this kind of teams, some events of "epiphany", called "knowledge transfer" in this context, to happen. In those moments the whole group learns and adopts a new idea or method from another discipline.&lt;/p&gt;
&lt;p&gt;The idea sounds good, but the practical implementation has some difficulties worth mentioning. To begin with, this groups usually are created inside traditional departments. This makes one of the disciplines to be over-represented (in my case, biology), and this creates some inertia. Some people tell the joke that a multidisciplinary team is a traditional department that once hired a physicist for helping with the simulations.&lt;/p&gt;
&lt;p&gt;One may think (at least I did) that the bigger difficulty in order to adapt to a multidisciplinary group would be acquiring the required knowledge from the other disciplines. Curiously, my experience has been that this difficulty is secondary: precisely because being inside a multidisciplinary team, there's always some expert close who can help. Then, that is the main difficulty? No doubt: &lt;strong&gt;communication&lt;/strong&gt;, and on a very deep level. Different disciplines use not only different technical jargon (this is the less important problem), but also different tools and, more seriously, they have different academical cultures.&lt;/p&gt;
&lt;p&gt;And academical cultures are a more serious difficulty than it may seem. Nowadays, I can identify a physicist, engineer or mathematician just looking at his face when I say: &lt;em&gt;"I am the only one using LaTeX in my department"&lt;/em&gt;. These small details affect the way papers are written, and even the way problems are solved (and even posed!). In the next lines we'll see some examples.&lt;/p&gt;
&lt;p&gt;In my everyday life I collaborate with biologists and mathematicians in the posing, analysis and solving of mathematical models with biological interest. In both groups I've observed ways of working that I personally like... and some others that I like less.&lt;/p&gt;
&lt;p&gt;Among mathematicians, I find remarkable the exquisite care they put in notation, and their detail in the problem-posing phase. On the other hand, they tend to be reluctant to apply numerical methods, even when there is no other choice.&lt;/p&gt;
&lt;p&gt;About biologists, it is remarkable that they are never afraid of tackling any problem, regardless of how complex it is. They don't hesitate in using all the numerical artillery as soon as it is possible. To the contrary of mathematicians, they tend to pose the problems in a blurrier way and add more specifications on-the-go. Maybe what I like the less is that some biology journals follow strictly the rule &lt;em&gt;"each printed equation halves the number of readers"&lt;/em&gt;, and they rather write lengthy paragraphs than a single equation containing the same information (if you're lucky, maybe you can find the equation in the appendix).&lt;/p&gt;
&lt;p&gt;I'm pretty sure that some of the physicists' characteristics are strange for them. In fact, it is symptomatic that, from my point of view, mathematicians and biologists lie on both the extremes of a continuum (rigour vs. quick problem solving), in which center curiously and suspiciously lies physics.&lt;/p&gt;
&lt;p&gt;We should not forget that research groups are also human groups, with vices, virtues, interests, etc. In a multidisciplinary group, communication has to be fluid not only in the sense of information transfer but also in the sense of empathetic communication. Not only to understand other people motivations to do things "their way" (you can like it more or less, but there's always a motivation), but also to make the &lt;em&gt;"knowledge transfer"&lt;/em&gt; deserve its name, and not be a mere &lt;em&gt;"I can do it better"&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Maybe, the best abstract of the situation is that, after more than two years working in a multidisciplinary group, I still cannot decide if I love it or hate it. Anyway, I dare to leave here some advice, just in case someone finds it interesting:&lt;/p&gt;
&lt;h2&gt;Understand their methods&lt;/h2&gt;
&lt;p&gt;The first reaction when we face an unusual method tends to be rejection (look, for instance, the scholarly fights about notations for derivative (I wrote about this &lt;a href="http://fuga.naukas.com/2016/03/10/derivadas-con-primas-o-diferenciales/"&gt;here&lt;/a&gt;, in Spanish). My experience is that, even if at the end we decide that "our" method is better suited for the given problem, it is worth to stop and understand the motivations for using something different.&lt;/p&gt;
&lt;h2&gt;Explain your methods&lt;/h2&gt;
&lt;p&gt;Practical example: most people in my department, including my supervisors, use &lt;em&gt;Word&lt;/em&gt;, but I use &lt;em&gt;LaTeX&lt;/em&gt;. At the beginning of my project, I explained to them my reasons for doing so, and we reached minimum agreement about how to collaborate without forcing them to learn how to use  &lt;em&gt;LaTeX&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Learn your own way&lt;/h2&gt;
&lt;p&gt;It is very likely that the sources your colleagues use are not the ideal for you. In the case of mathematical biology, there are books and journals more or less bent towards biological or mathematical styles. When it comes to learning new ideas, I try to use the more mathematical ones. There's no need of not using the expertise you gained during your degree studies. When it comes to publishing, once again, an agreement should be required with your collaborators about the style and the target journal.&lt;/p&gt;
&lt;h2&gt;Make a reasonable partition of your schedule&lt;/h2&gt;
&lt;p&gt;Multidisciplinary groups are rarely evenly composed. Practical example: if you are the only statistician in a medicine department with physicians, chemists and biologists, it is very likely that everyone is interested in your help. Probably, to the contrary, only a couple of other people's projects will be meaningful for your research. This situation may escalate into a problem if you don't establish some reasonable limits for the time you spend helping others.&lt;/p&gt;
&lt;h2&gt;In the end, your thesis is yours&lt;/h2&gt;
&lt;p&gt;To be part of a multidisciplinary group doesn't mean to completely abandon your interests and previous training. At the end, you are the responsible of your publications. Your directors, so to say, occupy the co-pilot seat.&lt;/p&gt;
&lt;h2&gt;Don't apologize for being a physicist, a biologist, ...&lt;/h2&gt;
&lt;p&gt;If your discipline represents a minority inside the group or, even worse, if you are the only representative of it, you may feel that it is not worth giving your opinion. This is a mistake. It is exactly in these situations when you feel you have to say something that nobody before said, when it is most likely that something significant is communicated.&lt;/p&gt;
&lt;p&gt;After all, this why they hired you. Didn't they?&lt;/p&gt;</content><category term="Blog"></category><category term="math"></category><category term="biology"></category></entry><entry><title>Cosas que he aprendido trabajando en un grupo multidisciplinar</title><link href="https://pabrod.github.io/multidisciplinary-es.html" rel="alternate"></link><published>2018-06-12T16:04:02+02:00</published><updated>2018-06-12T16:04:02+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-06-12:/multidisciplinary-es.html</id><summary type="html">&lt;p&gt;Un físico que trabaja como matemático en un departamento de ecología acuática&lt;/p&gt;</summary><content type="html">&lt;p&gt;Como algunos de ustedes saben, yo soy físico. A pesar de ello, trabajo como matemático en un departamento de... ¡ecología acuática! Esta situación, además de generarme una considerable crisis de identidad, hace que dedique bastante tiempo a pensar sobre ese concepto tan difuso y tan de moda que es la "multidisciplinaridad".&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Sigue leyendo en &lt;a href="http://fuga.naukas.com/2018/06/12/grupo-multidisciplinar"&gt;Naukas&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;</content><category term="Blog"></category><category term="math"></category><category term="biology"></category></entry><entry><title>Seminar announcement: A mathematician among biologists (Imperial College London)</title><link href="https://pabrod.github.io/seminar-imperial-en.html" rel="alternate"></link><published>2018-06-10T12:27:50+02:00</published><updated>2018-06-10T12:27:50+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-06-10:/seminar-imperial-en.html</id><summary type="html">&lt;p&gt;Invasive species: a mathematician among biologists, 19 June 2018, Imperial College London&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Title&lt;/h2&gt;
&lt;p&gt;Invasive species: a mathematician among biologists&lt;/p&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;This is a story about multidisciplinarity. It starts with a theoretical physicist being hired as a mathematician by a biology department. But what is the role of a mathematician in such a singular ecosystem? In this talk, we'll learn that the relation between biology and mathematics can be traced back to the XIII century. We'll also learn that the survival of plankton communities is strongly related with chaotic attractors, and how differential geometry had an unexpected role in a science communication problem.&lt;/p&gt;
&lt;h2&gt;Key references&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Huisman J, Weissing FJ. Biodiversity of plankton by species oscillations and chaos. Nature [Internet]. 1999 Nov 25;402(6760):407–10. Available &lt;a href="http://www.nature.com/articles/46540"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Gottwald GA, Melbourne I. On the Implementation of the 0-1 Test for Chaos. SIAM J Appl Dyn Syst [Internet]. 2009 Jan [cited 2017 May 9];8(1):129–45. Available &lt;a href="https://arxiv.org/pdf/0906.1418.pdf%22%3Ehttps://arxiv.org/pdf/0906.1418.pdf"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Zhou JX, Aliyu MDS, Aurell E, Huang S. Quasi-potential landscape in complex multi-stable systems. J R Soc Interface [Internet]. 2012 Dec 7 [cited 2017 Feb 28];9(77):3539–53. Available &lt;a href="http://rsif.royalsocietypublishing.org/cgi/doi/10.1098/rsif.2012.0434"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Bhattacharya S, Zhang Q, Andersen ME. A deterministic map of Waddington’s epigenetic landscape for cell fate specification. BMC Syst Biol [Internet]. 2011 [cited 2017 Feb 28];5. Available &lt;a href="http://www.biomedcentral.com/1752-0509/5/85"&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Links&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://wwwf.imperial.ac.uk/~mrasmuss/DynamIC/index.php"&gt;Department's website&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Spacetime coordinates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;19 June 2018, 14:00-15:00 (local timezone)&lt;/li&gt;
&lt;li&gt;Huxley Building, South Kensington Campus. Room 130. Imperial College London.&lt;/li&gt;
&lt;/ul&gt;
&lt;iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2483.8125522417527!2d-0.1791236342303548!3d51.49830722963361!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x4876055c7df7c537%3A0x2541470e75df5fe0!2sHuxley+Building!5e0!3m2!1ses!2snl!4v1528627031939" width="600" height="450" frameborder="0" style="border:0" allowfullscreen&gt;&lt;/iframe&gt;</content><category term="Blog"></category><category term="announcement"></category></entry><entry><title>Course announcement: Introduction to PDEs</title><link href="https://pabrod.github.io/intro-to-pdes-en.html" rel="alternate"></link><published>2018-06-06T13:13:30+02:00</published><updated>2018-06-06T13:13:30+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-06-06:/intro-to-pdes-en.html</id><summary type="html">&lt;p&gt;Quick introduction to Partial Differential Equations, 7 June 2018, Wageningen University&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Quick introduction to Partial Differential Equations&lt;/h2&gt;
&lt;p&gt;On Thursday 7th, I'll give a crash course on partial differential equations at Wageningen University. Due to the diversity of backgrounds of the attendants, I'll try to focus in the key concepts, using graphical approaches as much as I can. Later on, we'll move forward to the numerical approach.&lt;/p&gt;
&lt;h2&gt;Outline&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;What's the difference between partial and ordinary differential equations?&lt;/li&gt;
&lt;li&gt;Vector calculus in a nutshell&lt;/li&gt;
&lt;li&gt;Classical PDEs&lt;/li&gt;
&lt;li&gt;Classical boundary conditions&lt;/li&gt;
&lt;li&gt;Hand-on examples with &lt;em&gt;Matlab&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Requirements&lt;/h2&gt;
&lt;p&gt;Please bring your laptop. The numerical examples will be solved using &lt;em&gt;Matlab's PDE Toolbox&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Materials&lt;/h2&gt;
&lt;p&gt;The slides and some code examples are available at &lt;a href="https://github.com/PabRod/intro-to-pdes"&gt;this link&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Spacetime coordinates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;7 June 2018, 13:30-16:30.&lt;/li&gt;
&lt;li&gt;Room E.111, Lumen.&lt;/li&gt;
&lt;/ul&gt;</content><category term="Blog"></category><category term="math"></category><category term="teaching"></category></entry><entry><title>Embedding a Shiny app inside my blog</title><link href="https://pabrod.github.io/embed-shiny-en.html" rel="alternate"></link><published>2018-05-05T15:54:09+02:00</published><updated>2018-05-05T15:54:09+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-05-05:/embed-shiny-en.html</id><summary type="html">&lt;p&gt;Embedding shiny apps inside an html page&lt;/p&gt;</summary><content type="html">&lt;p&gt;Some years ago, I started experimenting with the computing language &lt;em&gt;R&lt;/em&gt;. I have to confess that I don't feel fully comfortable with its syntax, which I find particularly difficult. But I forced myself to get used to it. Why? My main reasons were two: &lt;a href="https://yihui.name/knitr/"&gt;knitr&lt;/a&gt; and &lt;a href="https://shiny.rstudio.com"&gt;shiny&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Knitr&lt;/strong&gt; is the perfect tool for literate computing. It allows the user to input a combination of code and markdown text providing a clean, human-readable document as output. Indeed, I'm using knitr for writing parts of this website (for example, the &lt;a href="https://pabrod.github.io/pages/sci-comm-en.html"&gt;dissemination section&lt;/a&gt;).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Shiny&lt;/strong&gt; is great for making interactive apps, and publishing them as easy-to-use webpages.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For more (and certainly better) information... just google some tutorials. In this short entry, I only want to show an example of what shiny can do (and see how good it works with my new blog).&lt;/p&gt;
&lt;p&gt;Take a look at the following simulation I made some years ago to teach some basic ideas about statistical inference:&lt;/p&gt;
&lt;iframe src="https://pabrod.shinyapps.io/shiny/"
        style="border: 2px solid black; width: 100%; height: 1000px;"&gt;&lt;/iframe&gt;

&lt;p&gt;The steps followed were:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Write the app itself. Of course, this is the difficult part.&lt;/li&gt;
&lt;li&gt;Publish it. The easiest way is uploading it to &lt;a href="https://www.shinyapps.io"&gt;ShinyApps&lt;/a&gt;. The most popular &lt;em&gt;R&lt;/em&gt; editor, &lt;a href="https://www.rstudio.com"&gt;RStudio&lt;/a&gt;, can do this almost automatically.&lt;/li&gt;
&lt;li&gt;Once this two steps are made, the insertion code I've used is as simple as:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;iframe src="https://pabrod.shinyapps.io/shiny/"
        style="border: 2px solid black; width: 100%; height: 1000px;"&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;I'm a big fan of simulation and interactive teaching. More apps will be published soon. Some of them can be previewed in &lt;a href="https://www.geogebra.org/u/pablorodriguez"&gt;GeoGebraTube&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This entry appears in &lt;a href="https://www.r-bloggers.com"&gt;R-bloggers.com&lt;/a&gt; &lt;/p&gt;</content><category term="Blog"></category><category term="r"></category><category term="simulation"></category><category term="how-to"></category></entry><entry><title>There's a nerd in my elevator!</title><link href="https://pabrod.github.io/elevator-en.html" rel="alternate"></link><published>2018-05-01T12:24:00+02:00</published><updated>2018-05-01T12:24:00+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-05-01:/elevator-en.html</id><summary type="html">&lt;p&gt;An elevator, a phone, ... and a nerd&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;This text appeared first in &lt;a href="http://fuga.naukas.com/2018/02/06/un-empollon-en-mi-ascensor/"&gt;Naukas&lt;/a&gt;, where was originally written in Spanish.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Recently I started a secondment at the Friedrich Schiller University, in Jena, Germany. Surprisingly, my office during the next months is located in the 18th floor of a skyscraper. The Jentower in particular:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Jentower" src="http://fuga.naukas.com/files/2018/02/2018-01-30-16.34.25-360x640.jpg"&gt;&lt;/p&gt;
&lt;p&gt;But I'm not writing this to boast about the views of my new office. On the contrary, I'll destroy any possible idea of glamour related to work in a place like this. And I'll do it with a confession: I became the crazy guy who leaves his cell phone on the ground while he uses the elevator. Let me explain:&lt;/p&gt;
&lt;p&gt;A building of almost 150 meters high needs fast elevators. The ones in this building have a very powerful, scary acceleration. Then, I remembered that smartphones usually contain an accelerometer, so I tried to measure those accelerations.&lt;/p&gt;
&lt;p&gt;I used an app called &lt;a href="https://sciencejournal.withgoogle.com"&gt;Google Science Journal&lt;/a&gt;, that allows registering data from all sensors available in the phone (accelerometers, light, magnetic field, ...) and export them in a format (.csv) quite easy to analyze on a computer. If you like getting your hands dirty, install it now!&lt;/p&gt;
&lt;p&gt;In the figure below we can see the vertical acceleration profile during my trip to the 18th floor this morning, where we can clearly see the initial "kick" (seconds 9 to 14) and the braking (28 to 33)&lt;/p&gt;
&lt;p&gt;&lt;img alt="accel" src="http://fuga.naukas.com/files/2018/02/acel1-580x391.png"&gt;
Vertical acceleration (excluding gravity)&lt;/p&gt;
&lt;p&gt;Accelerations of 1 m/s^2 sustained during 4 seconds! You can feel that in your stomach!&lt;/p&gt;
&lt;p&gt;Using this data, we can explore a bit further. We can use a time series of the acceleration to compute speed and position. How? Maybe you remember from high school's physics that position, speed and acceleration are related through derivatives. More specifically.&lt;/p&gt;
&lt;p&gt;&lt;img alt="diff" src="http://fuga.naukas.com/files/2018/02/diff.png"&gt;&lt;/p&gt;
&lt;p&gt;With the previous recipe we can compute speed using the position, and then use speed to compute acceleration. Like in a production chain. Nevertheless, in our case we want to do the opposite process. Luckily, we can use indefinite integrals to "revert" our derivatives, and thus our whole "production chain".&lt;/p&gt;
&lt;p&gt;&lt;img alt="int" src="http://fuga.naukas.com/files/2018/02/int.png"&gt;&lt;/p&gt;
&lt;p&gt;So, by integrating the acceleration (to obtain the speed), and then integrating the speed (to obtain the position) we find results like this:&lt;/p&gt;
&lt;p&gt;&lt;img alt="results" src="http://fuga.naukas.com/files/2018/02/all-580x564.png"&gt;
Acceleration, speed and position&lt;/p&gt;
&lt;p&gt;So, using only a device that most of us carry everywhere and some elementary physical concepts we know that:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Our elevator runs up at 4 m/s.&lt;/li&gt;
&lt;li&gt;My office is 74 meter above the ground.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Such a great time to be a nerd!&lt;/p&gt;
&lt;p&gt;If someone is interested in exploring a bit deeper into the details (for instance: how to filter out the effects of gravity, how to integrate a time series, ... ) or even experiment with his or her own elevator, &lt;a href="https://github.com/PabRod/elevator-tool"&gt;here is a link&lt;/a&gt; to the code I've used.&lt;/p&gt;</content><category term="Blog"></category><category term="physics"></category><category term="python"></category></entry><entry><title>Un empollón en mi ascensor</title><link href="https://pabrod.github.io/elevator-es.html" rel="alternate"></link><published>2018-05-01T12:24:00+02:00</published><updated>2018-05-01T12:24:00+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-05-01:/elevator-es.html</id><summary type="html">&lt;p&gt;Un ascensor, un teléfono móvil... y un empollón&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;Este artículo se publicó originalmente en español en &lt;a href="http://fuga.naukas.com/2018/02/06/un-empollon-en-mi-ascensor/"&gt;Naukas&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;</content><category term="Blog"></category><category term="physics"></category><category term="python"></category></entry><entry><title>Welcome</title><link href="https://pabrod.github.io/welcome-en.html" rel="alternate"></link><published>2018-04-23T12:24:00+02:00</published><updated>2018-04-23T12:24:00+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-04-23:/welcome-en.html</id><summary type="html">&lt;p&gt;Description of the motivations and topic of this blog&lt;/p&gt;</summary><content type="html">&lt;p&gt;Despite I have &lt;a href="https://sites.google.com/site/pablorodriguezsanchez/"&gt;a personal webpage&lt;/a&gt; in Google Sites since some years ago, I got tired of updating it. The main reason is that it was an extremely manual task, that forced me to copypaste the same pieces of information in several places. The virtue of lazyness, when well understood, is the mother of programming and automation, so I started exploring other possibilities. In particular, I wanted something that could be well integrated with &lt;a href="https://yihui.name/knitr/"&gt;knitr&lt;/a&gt;. Thanks to the blog &lt;a href="https://rinzewind.org/blog-en/"&gt;Will do stuff for stuff&lt;/a&gt; I discovered &lt;a href="https://blog.getpelican.com"&gt;Pelican&lt;/a&gt;, that allows to create websites from local files in a relatively easy way.&lt;/p&gt;
&lt;p&gt;The two main problems I face at the early days of this new website are:&lt;/p&gt;
&lt;h2&gt;Archiving&lt;/h2&gt;
&lt;p&gt;After some years working in science, I've produced a certain amount of materials that are now spread around at different webpages. Thanks to &lt;a href="https://yihui.name/knitr/"&gt;knitr&lt;/a&gt;, I can keep this registry updated while only keeping updated a Spreadsheet.&lt;/p&gt;
&lt;p&gt;For details, see &lt;a href="https://github.com/PabRod/academic-record"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Translating&lt;/h2&gt;
&lt;p&gt;Pelican gave me a nice surprise: it manages translations very well. This is specially relevant for me, because most of my work before my emigration to the Netherlands is written in Spanish. On the mid term, I hope to translate those materials whom I consider most relevant.&lt;/p&gt;
&lt;h1&gt;What will I find here?&lt;/h1&gt;
&lt;p&gt;The answer is easy: as in any other personal page, here you'll find anything the author considered worth being shared.&lt;/p&gt;
&lt;p&gt;Posts will be written in English, Spanish and/or, to a lesser extent, in Dutch.&lt;/p&gt;</content><category term="Blog"></category><category term="about"></category></entry><entry><title>Bienvenida</title><link href="https://pabrod.github.io/welcome-es.html" rel="alternate"></link><published>2018-04-23T12:24:00+02:00</published><updated>2018-04-23T12:24:00+02:00</updated><author><name>Pablo Rodríguez-Sánchez</name></author><id>tag:pabrod.github.io,2018-04-23:/welcome-es.html</id><summary type="html">&lt;p&gt;Motivación y temática del blog&lt;/p&gt;</summary><content type="html">&lt;p&gt;Aunque hace tiempo que tengo &lt;a href="https://sites.google.com/site/pablorodriguezsanchez/"&gt;una página personal&lt;/a&gt; en Google Sites, lo cierto es que me cansé de actualizarla. El principal motivo es que era una tarea demasiado manual, que me obligaba a actualizar la misma pieza de información en varios lugares distintos. La virtud de la pereza, que bien entendida es la madre de la programación y la automatización, me llevó a investigar otras posibilidades. En particular, buscaba algo que se integrase bien con &lt;a href="https://yihui.name/knitr/"&gt;knitr&lt;/a&gt;. Gracias al blog &lt;a href="https://rinzewind.org/blog-en/"&gt;Will do stuff for stuff&lt;/a&gt; descubrí &lt;a href="https://blog.getpelican.com"&gt;Pelican&lt;/a&gt;, que permite generar sitios web a partir de archivos locales con cierta agilidad.&lt;/p&gt;
&lt;p&gt;Los dos principales problemas a los que me enfrento al abrir esta web son:&lt;/p&gt;
&lt;h2&gt;Reunir&lt;/h2&gt;
&lt;p&gt;Tras varios años dedicándome a la ciencia, he producido una considerable cantidad de materiales que han acabado desperdigados por distintas webs. Soy un tipo ordenado y llevo un registro de todos ellos en una Spreadsheet de GoogleDrive. Usando &lt;a href="https://yihui.name/knitr/"&gt;knitr&lt;/a&gt;, puedo mantener este registro actualizado leyendo de una hoja de cálculo, ahorrándome así la humillación de copiar a mano.&lt;/p&gt;
&lt;p&gt;Detalles &lt;a href="https://github.com/PabRod/academic-record"&gt;aquí&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Traducir&lt;/h2&gt;
&lt;p&gt;Pelican me ha dado una grata sorpresa: gestiona de maravilla las traducciones. Esto es especialmente relevante para mí, pues la mayor parte de mi trabajo previo a mi emigración a los Países Bajos está escrito en lengua española. A medio plazo, me propongo traducir aquellos materiales que considero más relevantes al inglés.&lt;/p&gt;
&lt;h1&gt;¿Qué voy a encontrar aquí?&lt;/h1&gt;
&lt;p&gt;La respuesta es sencilla: como en cualquier blog personal, aquí encontrarás cualquier cosa que el autor considere digna de ser compartida.&lt;/p&gt;
&lt;p&gt;Los idiomas utilizados serán inglés, español y/o en menor medida neerlandés.&lt;/p&gt;</content><category term="Blog"></category><category term="about"></category></entry></feed>